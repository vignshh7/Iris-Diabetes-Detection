import cv2
import numpy as np
import os
import json
import sys

# Add project root to path for config import
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
from config import *

def create_circular_mask_from_points(image_path, output_path, points):
    """
    Creates a circular binary mask by finding the minimum enclosing circle
    that fits the provided annotation points.

    Args:
        image_path (str): Path to the original image (to get dimensions).
        output_path (str): Path where the generated mask will be saved.
        points (np.ndarray): A NumPy array of (x, y) coordinates.

    Returns:
        bool: True if successful, False otherwise.
    """
    # Read the original image to get its exact dimensions
    img = cv2.imread(image_path)
    if img is None:
        print(f"Error: Could not load image {image_path}")
        return False
    
    # Create a blank, single-channel mask with the same dimensions
    mask = np.zeros((img.shape[0], img.shape[1]), dtype=np.uint8)
    
    # --- THIS IS THE KEY CHANGE ---
    # Instead of drawing a polygon, find the minimum enclosing circle for the points.
    # This function returns ((center_x, center_y), radius).
    (x, y), radius = cv2.minEnclosingCircle(points)
    
    # Convert the center and radius to integers for drawing
    center = (int(x), int(y))
    radius = int(radius)
    
    # Draw the filled circle on the mask.
    # Color 255 (white) for the iris, thickness -1 to fill the circle.
    cv2.circle(mask, center, radius, 255, -1)
    
    # Save the final circular mask as a lossless PNG file
    cv2.imwrite(output_path, mask)
    print(f"Saved CIRCULAR mask for {os.path.basename(image_path)} to {output_path}")
    return True

def process_dataset(annotations, input_dir=None, output_dir=None):
    """
    Processes a list of annotations to generate circular binary masks.
    """
    if input_dir is None:
        input_dir = CONTROL_DIR
    if output_dir is None:
        output_dir = MASKS_DIR
    
    os.makedirs(output_dir, exist_ok=True)
    
    total_images = len(annotations)
    successful = 0
    failed = []
    
    for metadata_id, filename_json, spatial_coords in annotations:
        try:
            # Use json.loads for robust filename parsing
            filename = json.loads(filename_json)[0]
            input_path = os.path.join(input_dir, filename)

            # Check for valid coordinates
            if len(spatial_coords) < 7 or spatial_coords[0] != 9:
                print(f"Warning: Invalid or insufficient coordinates for {filename}: {spatial_coords}")
                failed.append(filename)
                continue
            
            # Reshape the flat list [x1, y1, x2, y2, ...] into an array of points
            points = np.array(spatial_coords[1:], dtype=np.float32).reshape((-1, 2))

            output_filename = f"{os.path.splitext(filename)[0]}_mask.png"
            output_path = os.path.join(output_dir, output_filename)
            
            print(f"Processing {filename}...")
            # Use the new function to create a circular mask
            if create_circular_mask_from_points(input_path, output_path, points):
                successful += 1
            else:
                failed.append(filename)

        except Exception as e:
            print(f"An unexpected error occurred for annotation {metadata_id}: {e}")
            failed_filename = annotations[successful + len(failed)][1]
            failed.append(f"{failed_filename} (due to error)")

    # Final summary
    print("\n--- Processing Complete ---")
    print(f"Total annotations processed: {total_images}")
    print(f"Successfully created masks: {successful}")
    print(f"Failed annotations: {len(failed)}")
    if failed:
        print("Failed files/annotations:", "\n - ".join(failed))
annotations = [
    ("1_jEpl7uBr", "[\"1L.IMG20250519125449.jpg\"]", [9, 1106.745, 849.501, 574.311, 1824.633, 1716.95, 1734.897]),
    ("2_fCvGhbtz", "[\"1R.IMG20250519125055.jpg\"]", [9, 951.20235, 1130.67449, 101.701, 1866.51, 1375.953, 1435.777]),
    ("3_0S2GXTPq", "[\"2L.IMG20250519125955.jpg\"]", [9, 1106.745, 963.167, 400.821, 1645.161, 1758.827, 1716.95]),
    ("4_wMNRSFXN", "[\"2R.IMG20250519125703.jpg\"]", [9, 885.396, 1369.971, 83.754, 2225.455, 1663.109, 2333.138]),
    ("5_JunXaWVj", "[\"3L.IMG20250525161650.jpg\"]", [9, 903.343, 1106.745, 317.067, 1782.757, 1471.672, 2004.106]),
    ("6_TF61XB3J", "[\"3R.IMG20250519130343.jpg\"]", [9, 921.29, 1100.762, 227.331, 1830.616, 1657.126, 1974.194]),
    ("7_0DyfthmC", "[\"4L.IMG20250525161924.jpg\"]", [9, 837.537, 753.783, 11.965, 1513.548, 1681.056, 2016.07]),
    ("8_mH6XDYGM", "[\"4R.IMG20250525162008.jpg\"]", [9, 981.114, 1118.71, 364.927, 1758.827, 1728.915, 2159.648]),
    ("9_XrhRoh6w", "[\"5L.IMG20250525162051.jpg\"]", [9, 891.378, 957.185, 251.261, 1573.372, 1507.566, 1800.704]),
    ("10_XQR7hIQY", "[\"6L.IMG20250525162311.jpg\"]", [9, 825.572, 1274.252, 215.367, 1914.37, 1417.83, 2159.648]),
    ("11_29fvaDXg", "[\"6R.IMG20250525162244.jpg\"]", [9, 795.66, 1244.34, 293.138, 1770.792, 1262.287, 2147.683]),
    ("12_5qihk4MF", "[\"7L.IMG20250525162750.jpg\"]", [9, 909.326, 1369.971, 233.314, 2010.088, 1465.689, 2117.771]),
    ("13_G671kDXB", "[\"7R.IMG20250525162715.jpg\"]", [9, 921.29, 981.114, 424.751, 1699.003, 1710.968, 2063.93]),
    ("14_usHkcSJo", "[\"8L.IMG20250525163215.jpg\"]", [9, 795.66, 1274.252, 215.367, 1902.405, 1369.971, 2135.718]),
    ("15_Td2DyiKN", "[\"8R.IMG20250525163201.jpg\"]", [9, 1070.85, 1447.742, 562.346, 1944.282, 1447.742, 2327.155]),
    ("16_RtqzzIeA", "[\"8R.IMG20250525165119.jpg\"]", [9, 831.554, 1369.971, 376.891, 1872.493, 1214.428, 2255.367]),
    ("17_WN5gWAPz", "[\"9L.IMG20250525165153.jpg\"]", [9, 550.381, 1262.287, 323.05, 2135.718, 1070.85, 2195.543]),
    ("18_pMIEet7U", "[\"10L.IMG20250525165821.jpg\"]", [9, 915.308, 981.114, 466.628, 1740.88, 1387.918, 1962.229]),
    ("19_fHLqgXqc", "[\"10R.IMG20250525165746.jpg\"]", [9, 771.73, 1603.284, 340.997, 2410.909, 1202.463, 2470.733]),
    ("20_dncWqyZI", "[\"11L.IMG20250525171900.jpg\"]", [9, 963.167, 1256.305, 502.522, 1920.352, 1358.006, 2207.507]),
    ("21_WX7fSN7X", "[\"11R.IMG20250525170623.jpg\"]", [9, 885.396, 1531.496, 364.927, 2303.226, 1292.199, 2572.434]),
    ("22_gwpTAjBS", "[\"12L.IMG20250525173006.jpg\"]", [9, 945.22, 1752.845, 430.733, 2518.592, 1447.742, 2745.924]),
    ("23_YFPjB0Ho", "[\"12R.IMG20250525172933.jpg\"]", [9, 987.097, 1597.302, 520.469, 2398.944, 1477.654, 2614.311]),
    ("24_ITXfnq3w", "[\"13L.IMG20250525173535.jpg\"]", [9, 867.449, 1447.742, 418.768, 2141.701, 1274.252, 2410.909]),
    ("25_XLxPnHOd", "[\"13R.IMG20250525173511.jpg\"]", [9, 969.15, 1663.109, 616.188, 2267.331, 1447.742, 2416.891]),
    ("26_CXy1XcXL", "[\"14L.IMG20250525173633.jpg\"]", [9, 795.66, 1501.584, 263.226, 2375.015, 1405.865, 2536.54]),
    ("27_oAiECzpw", "[\"14L.IMG20250529204151.jpg\"]", [9, 903.343, 1274.252, 412.786, 2452.786, 1555.425, 2566.452]),
    ("28_QtXqZMUa", "[\"14R.IMG20250525173609.jpg\"]", [9, 747.801, 1746.862, 376.891, 2518.592, 1214.428, 2745.924]),
    ("29_2KkFgmtY", "[\"15L.IMG20250525173850.jpg\"]", [9, 933.255, 1609.267, 1017.009, 2692.082, 460.645, 2369.032]),
    ("30_772Pa8Iq", "[\"15R.IMG20250525173836.jpg\"]", [9, 927.273, 1938.299, 466.628, 2811.73, 1435.777, 2817.713]),
    ("31_r4dd9sCM", "[\"16L.IMG20250525174009.jpg\"]", [9, 1005.044, 1866.51, 550.381, 2775.836, 1579.355, 2829.677]),
    ("32_Ob1aEIsc", "[\"16R.IMG20250525173953.jpg\"]", [9, 933.255, 1681.056, 412.786, 2518.592, 1447.742, 2572.434]),
    ("33_TsXTMv2n", "[\"17L.IMG20250525161907.jpg\"]", [9, 843.519, 1214.428, 406.804, 2297.243, 1465.689, 2506.628]),
    ("34_UgCutCdB", "[\"17R.IMG20250525175116.jpg\"]", [9, 819.589, 1274.252, 412.786, 2279.296, 1483.636, 2446.804]),
    ("35_aiAdxbyY", "[\"18L.IMG20250525162054.jpg\"]", [9, 454.663, 1082.815, 311.085, 2004.106, 1082.815, 2159.648]),
    ("36_jcIRM16d", "[\"18R.IMG20250525162012.jpg\"]", [9, 933.255, 1082.815, 484.575, 2069.912, 1627.214, 2135.718]),
    ("37_0Txhx715", "[\"19L.IMG20250525162854.jpg\"]", [9, 747.801, 1639.179, 269.208, 2452.786, 1226.393, 2572.434]),
    ("38_Q7fnYeMv", "[\"19R.IMG20250525162708.jpg\"]", [9, 723.871, 1214.428, 305.103, 2249.384, 1405.865, 2375.015]),
    ("39_Tc8RYJWt", "[\"20L.IMG20250525163218.jpg\"]", [9, 825.572, 1393.9, 311.085, 2195.543, 1411.848, 2159.648]),
    ("40_XFhZgJ58", "[\"20R.IMG20250525163203.jpg\"]", [9, 945.22, 1334.076, 514.487, 2123.754, 1423.812, 2129.736]),
    ("41_TOi6g2ov", "[\"21L.IMG20250525165156.jpg\"]", [9, 699.941, 1238.358, 233.314, 1968.211, 1022.991, 2207.507]),
    ("42_pX9oLZ8a", "[\"21R.IMG20250525165121.jpg\"]", [9, 915.308, 1316.129, 496.54, 1998.123, 1226.393, 2189.56]),
    ("43_bZEjBfwT", "[\"22L.IMG20250525171853.jpg\"]", [9, 1082.815, 1256.305, 867.449, 2129.736, 1459.707, 2255.367]),
    ("44_7CvT7FbV", "[\"22R.IMG20250525170625.jpg\"]", [9, 915.308, 1615.249, 472.61, 2422.874, 1190.499, 2686.1]),
    ("45_QKJel4t5", "[\"23L.IMG20250525172839.jpg\"]", [9, 610.205, 1896.422, 329.032, 2710.029, 1005.044, 2733.959]),
    ("46_XK6kR84e", "[\"23R.IMG20250525172740.jpg\"]", [9, 711.906, 1633.196, 496.54, 2494.663, 1232.375, 2327.155]),
    ("47_aDaKxHSF", "[\"24L.IMG20250525162049_COVER.jpg\"]", [9, 927.273, 1017.009, 376.891, 1842.581, 1328.094, 2195.543]),
    ("48_GuDsv5Gx", "[\"24R.IMG20250525172030.jpg\"]", [9, 723.871, 1465.689, 681.994, 2392.962, 1148.622, 2380.997]),
    ("49_Gp1ieyX4", "[\"25L.IMG20250525162855.jpg\"]", [9, 1028.974, 1346.041, 562.346, 2153.666, 1501.584, 2327.155]),
    ("50_0EgzcaqS", "[\"25R.IMG20250525172554.jpg\"]", [9, 723.871, 1459.707, 388.856, 2231.437, 1286.217, 2207.507]),
    ("51_0bsXc3an", "[\"26L.IMG20250525173537.jpg\"]", [9, 831.554, 1603.284, 628.152, 2446.804, 1363.988, 2452.786]),
    ("52_o86SXNPR", "[\"26R.IMG20250525173611.jpg\"]", [9, 747.801, 1764.809, 340.997, 2494.663, 1118.71, 2787.801]),
    ("53_GJHuxlFb", "[\"27L.IMG20250525175133.jpg\"]", [9, 681.994, 1214.428, 35.894, 2225.455, 1286.217, 2410.909]),
    ("54_HAiKsuJ4", "[\"27R.IMG20250525175537.jpg\"]", [9, 1011.026, 1818.651, 819.589, 2662.17, 1435.777, 2710.029]),
    ("55_yYoTldTX", "[\"28R.IMG20250525175638.jpg\"]", [9, 867.449, 1465.689, 580.293, 2404.927, 1471.672, 2428.856]),
    ("56_oQr9WZc6", "[\"28R.IMG20250525175736.jpg\"]", [9, 927.273, 1573.372, 556.364, 2494.663, 1363.988, 2590.381]),
    ("57_ohE0ES4E", "[\"29L.IMG20250525180926.jpg\"]", [9, 867.449, 1202.463, 430.733, 2171.613, 1411.848, 2339.12]),
    ("58_C7LYXlMc", "[\"29R.IMG20250525180012.jpg\"]", [9, 891.378, 1369.971, 616.188, 2237.419, 1465.689, 2327.155]),
    ("59_fnumws4Y", "[\"30L.IMG20250525181402.jpg\"]", [9, 676.012, 1214.428, 568.328, 2165.63, 1633.196, 1920.352]),
    ("60_rLEeb3FY", "[\"30R.IMG20250525181348.jpg\"]", [9, 885.396, 1352.023, 598.24, 2237.419, 1417.83, 2183.578]),
    ("61_ADAi13Q2", "[\"31L.IMG20250525182011.jpg\"]", [9, 634.135, 1800.704, 508.504, 2608.328, 1244.34, 2626.276]),
    ("62_MG5VlT14", "[\"31R.IMG20250525181945.jpg\"]", [9, 711.906, 1585.337, 484.575, 2548.504, 1154.604, 2680.117]),
    ("63_QrooF3FS", "[\"32L.IMG20250525191527.jpg\"]", [9, 1011.026, 1375.953, 789.677, 2351.085, 1621.232, 2315.191]),
    ("64_1nXKSo0n", "[\"32R.IMG20250525191212.jpg\"]", [9, 807.625, 1226.393, 269.208, 2141.701, 1340.059, 2434.839]),
    ("65_7a6tRYBO", "[\"33L.IMG20250525191525.jpg\"]", [9, 1082.815, 1226.393, 664.047, 2016.07, 1675.073, 2189.56]),
    ("66_XeYXxXfm", "[\"33R.IMG20250525191555.jpg\"]", [9, 861.466, 1447.742, 436.716, 2195.543, 1226.393, 2494.663]),
    ("67_aImKvYR2", "[\"34L.IMG20250525191911.jpg\"]", [9, 1022.991, 1782.757, 628.152, 2542.522, 1459.707, 2733.959]),
    ("68_bQHoXpxX", "[\"34R.IMG20250525191849.jpg\"]", [9, 807.625, 2087.859, 388.856, 2805.748, 1154.604, 2973.255]),
    ("69_vqdp4WDq", "[\"36L.IMG20250528153939.jpg\"]", [9, 819.589, 1561.408, 376.891, 2375.015, 1280.235, 2865.572]),
    ("70_Cj3ULF9j", "[\"36R.IMG20250528154014.jpg\"]", [9, 813.607, 1537.478, 335.015, 2548.504, 1238.358, 2721.994]),
    ("71_Owxc3sf8", "[\"37L.IMG20250528154254.jpg\"]", [9, 867.449, 1040.938, 203.402, 2183.578, 1525.513, 2321.173]),
    ("72_l4ZIXXFY", "[\"37R.IMG20250528154338.jpg\"]", [9, 921.29, 1052.903, 251.261, 1938.299, 1292.199, 2375.015]),
    ("73_bJzknqaP", "[\"38L.IMG20250528155509.jpg\"]", [9, 789.677, 1172.551, 269.208, 2016.07, 1226.393, 2255.367]),
    ("74_0s5TjSUt", "[\"38R.IMG20250528154747.jpg\"]", [9, 771.73, 1465.689, 335.015, 2446.804, 1441.76, 2279.296]),
    ("75_cle1zBl6", "[\"39L.IMG20250529203844.jpg\"]", [9, 705.924, 1340.059, 257.243, 2183.578, 1136.657, 2416.891]),
    ("76_GImNlgch", "[\"39R.IMG20250529203801.jpg\"]", [9, 741.818, 1256.305, 364.927, 2189.56, 1280.235, 2189.56]),
    ("77_Th8zGWhi", "[\"40L.IMG20250529203936.jpg\"]", [9, 795.66, 1405.865, 460.645, 2105.806, 1220.411, 2279.296]),
    ("78_oRhbFcJo", "[\"40R.IMG20250529204027.jpg\"]", [9, 819.589, 1256.305, 472.61, 2111.789, 1262.287, 2141.701]),
    ("79_dVn6WeaF", "[\"41R.IMG20250529204211.jpg\"]", [9, 741.818, 1076.833, 502.522, 2285.279, 1393.9, 2321.173]),
    ("80_nh8PXyrY", "[\"42R.IMG20250529204437.jpg\"]", [9, 813.607, 1052.903, 352.962, 2183.578, 1513.548, 2273.314]),
    ("81_aFKW1FVd", "[\"42R.IMG20250529204500.jpg\"]", [9, 825.572, 1256.305, 269.208, 2351.085, 1465.689, 2494.663]),
    ("82_kWuKk7fP", "[\"43L.IMG20250529205053.jpg\"]", [9, 819.589, 1274.252, 568.328, 2494.663, 1489.619, 2518.592]),
    ("83_X5hZYKmR", "[\"43R.IMG20250529204940.jpg\"]", [9, 939.238, 705.924, 245.279, 1884.457, 1597.302, 2087.859]),
    ("84_2C4968Xk", "[\"44R.IMG20250529205209.jpg\"]", [9, 795.66, 1166.569, 0, 1992.141, 1615.249, 2536.54]),
    ("85_ueg6ZtaW", "[\"44R.IMG20250529205238.jpg\"]", [9, 933.255, 825.572, 29.912, 1627.214, 1752.845, 1776.774]),
    ("86_m5cyrVu1", "[\"45L.IMG20250529205401.jpg\"]", [9, 807.625, 1369.971, 376.891, 2309.208, 1340.059, 2279.296]),
    ("87_QvgiXFQ8", "[\"45R.IMG20250529205340.jpg\"]", [9, 1082.815, 1322.111, 406.804, 2255.367, 1621.232, 2315.191]),
    ("88_XNNPmveJ", "[\"46L.IMG20250529205457.jpg\"]", [9, 963.167, 1280.235, 448.68, 2201.525, 1423.812, 2518.592]),
    ("89_xDBRWWPn", "[\"46R.IMG20250529205530.jpg\"]", [9, 765.748, 1531.496, 221.349, 2446.804, 1130.674, 2560.469]),
    ("90_5FbiIrvu", "[\"47R.IMG20250529205621.jpg\"]", [9, 909.326, 1369.971, 580.293, 2261.349, 1369.971, 2321.173]),
    ("91_iD5NLxQ3", "[\"47R.IMG20250529205653.jpg\"]", [9, 789.677, 1316.129, 448.68, 2087.859, 1405.865, 2153.666]),
    ("92_iLb0qQxQ", "[\"48L.IMG20250525175132.jpg\"]", [9, 1022.991, 1178.534, 604.223, 2494.663, 1633.196, 2464.751]),
    ("93_CIFbACHO", "[\"48R.IMG20250525181404.jpg\"]", [9, 831.554, 1244.34, 364.927, 2177.595, 1447.742, 2225.455]),
    ("94_mqFr3jH2", "[\"49L.IMG20250525182333.jpg\"]", [9, 837.537, 885.396, 317.067, 1848.563, 1495.601, 1818.651]),
    ("95_VEvwum6D", "[\"49R.IMG20250525191210.jpg\"]", [9, 705.924, 1130.674, 287.155, 1998.123, 1417.83, 2183.578]),
    ("96_84V67ioO", "[\"50L.IMG20250528151829.jpg\"]", [9, 753.783, 1154.604, 191.437, 2051.965, 1645.161, 2117.771]),
    ("97_C4VkAxmN", "[\"50R.IMG20250528151712.jpg\"]", [9, 903.343, 1130.674, 203.402, 2279.296, 1704.985, 2452.786]),
    ("98_jjRSh2gX", "[\"51L.IMG20250529205403.jpg\"]", [9, 801.642, 1334.076, 329.032, 2147.683, 1358.006, 2249.384]),
    ("99_HpFkrbqe", "[\"51R.IMG20250529205533.jpg\"]", [9, 891.378, 1657.126, 382.874, 2440.821, 1441.76, 2542.522]),
    ("100_0bZdrgKz", "[\"52L.IMG20250529204149.jpg\"]", [9, 879.413, 1220.411, 245.279, 2327.155, 1513.548, 2560.469]),
    ("101_sADFg1ve", "[\"52R.IMG20250529204209.jpg\"]", [9, 723.871, 1005.044, 179.472, 1866.51, 1537.478, 2016.07]),
    ("102_pyXZ8cYa", "[\"53L.IMG20250529203942.jpg\"]", [9, 771.73, 1429.795, 346.979, 1962.229, 1142.639, 2249.384]),
    ("103_1buwDvNT", "[\"53R.IMG20250529204034.jpg\"]", [9, 981.114, 1447.742, 580.293, 2183.578, 1459.707, 2231.437]),
    ("104_8F9WFVec", "[\"54L.IMG20250525182329.jpg\"]", [9, 915.308, 1322.111, 939.238, 1322.111, 885.396, 1322.111]),
    ("104_yHgX6LDk", "[\"54L.IMG20250525182329.jpg\"]", [9, 699.941, 1405.865, 526.452, 2183.578, 1369.971, 2285.279]),
    ("105_inzXKcmU", "[\"54R.IMG20250525180350.jpg\"]", [9, 891.378, 1142.639, 520.469, 1992.141, 1417.83, 2135.718]),
    ("106_KBKjXlur", "[\"55L.IMG20250528153950.jpg\"]", [9, 819.589, 1052.903, 203.402, 1878.475, 1495.601, 2016.07]),
    ("107_W1rvYYd5", "[\"55R.IMG20250528155637.jpg\"]", [9, 843.519, 1489.619, 454.663, 2279.296, 1489.619, 2159.648]),
    ("108_7hXhjPGI", "[\"56L.IMG20250529203054.jpg\"]", [9, 885.396, 1555.425, 496.54, 2428.856, 1585.337, 2608.328]),
    ("109_642DbREC", "[\"56R.IMG20250529205626.jpg\"]", [9, 1005.044, 1340.059, 568.328, 2063.93, 1603.284, 1986.158]),
    ("110_EUJQflvo", "[\"57L.IMG20250529203656.jpg\"]", [9, 1005.044, 1070.85, 508.504, 1956.246, 1573.372, 2040]),
    ("111_qeuaXs7C", "[\"57R.IMG20250529204503.jpg\"]", [9, 867.449, 1058.886, 269.208, 1968.211, 1591.32, 2159.648]),
    ("112_jEu9zXWN", "[\"58L.IMG20250529203653.jpg\"]", [9, 879.413, 1148.622, 394.839, 2040, 1597.302, 2075.894]),
    ("113_mhgWH9Hs", "[\"58R.IMG20250528154340.jpg\"]", [9, 921.29, 1082.815, 269.208, 1974.194, 1657.126, 2040]),
    ("114_6g3fKptE", "[\"60L.IMG20250529205503.jpg\"]", [9, 1022.991, 1220.411, 418.768, 2171.613, 1687.038, 2375.015]),
    ("115_XZ68EPQm", "[\"60R.IMG20250529205615.jpg\"]", [9, 951.202, 1369.971, 586.276, 2099.824, 1334.076, 2129.736]),
    ("116_AZnutqb1", "[\"61L.IMG20250528155511.jpg\"]", [9, 885.396, 1226.393, 418.768, 2051.965, 1465.689, 2135.718]),
    ("117_vapU4fqo", "[\"61R.IMG20250528155553.jpg\"]", [9, 951.202, 1633.196, 472.61, 2470.733, 1483.636, 2291.261])
]
if __name__ == '__main__':
    # Use centralized config paths
    input_directory = CONTROL_DIR
    output_directory = MASKS_DIR 
    
    process_dataset(annotations, input_directory, output_directory)